# ==========================================================
# VaultWarden-OCI-NG Environment Configuration
# ==========================================================
# This file serves as the single source of truth for all configuration variables
# Generated by setup.sh

# ==========================================================
# CORE CONFIGURATION (REQUIRED)
# ==========================================================

# Domain Configuration
# Your publicly accessible domain name (e.g., vault.example.com)
DOMAIN=vault.example.com

# Email address for admin notifications and Let's Encrypt registration
ADMIN_EMAIL=admin@example.com

# Project Configuration
# Internal Docker project name (used for container/network names)
COMPOSE_PROJECT_NAME=vaultwarden

# Directory on the host where persistent data is stored
PROJECT_STATE_DIR=/var/lib/vaultwarden

# ==========================================================
# USER & PERMISSIONS (P5 FIX)
# ==========================================================
# These are set automatically by setup.sh to match your host user
# This ensures containers have correct permissions to data volumes
UID=1000
GID=1000

# ==========================================================
# HOST CONFIGURATION (P7 FIX)
# ==========================================================
# SSH port for firewall configuration
# CRITICAL: If you use a custom SSH port, set it here to prevent
# the automated firewall updates from locking you out!
SSH_PORT=22

# ==========================================================
# CONTAINER VERSIONS
# ==========================================================
# Specify exact versions for stability. Update here, then run ./update.sh
VAULTWARDEN_VERSION=1.30.5
CADDY_VERSION=2.8.4
FAIL2BAN_VERSION=1.1.0
DDCLIENT_VERSION=3.11.2

# ==========================================================
# SERVICE CONFIGURATION
# ==========================================================

# VaultWarden Settings
# Note: These paths are explicit and must match PROJECT_STATE_DIR
VAULTWARDEN_DATA_FOLDER=/var/lib/vaultwarden/data
VAULTWARDEN_LOG_LEVEL=info

# Caddy Settings
CADDY_DATA_DIR=/var/lib/vaultwarden/caddy
CADDY_CONFIG_DIR=./caddy

# Fail2ban Settings
FAIL2BAN_CONFIG_DIR=./fail2ban
FAIL2BAN_LOG_LEVEL=INFO

# ==========================================================
# BACKUP CONFIGURATION (P10 FIX - Granular Retention)
# ==========================================================

# How many days to keep local backups before cleanup (type-specific)
DB_BACKUP_RETENTION_DAYS=14
FULL_BACKUP_RETENTION_DAYS=30
EMERGENCY_BACKUP_RETENTION_DAYS=90

# Encryption method (currently only 'age' is supported)
BACKUP_ENCRYPTION=age

# Rclone Remote Name (REQUIRED for offsite backups)
# The name of the remote you configured using 'rclone config'
# Examples: MyGDrive, B2Backup, OCI-ObjectStorage
RCLONE_REMOTE_NAME=CHANGE_ME

# ==========================================================
# NETWORK CONFIGURATION
# ==========================================================

# Name for the internal Docker network
DOCKER_NETWORK_NAME=vaultwarden_network

# ==========================================================
# CLOUDFLARE & DYNAMIC DNS (REQUIRED)
# ==========================================================

# Your Cloudflare Zone ID (find on your Cloudflare dashboard overview page)
CLOUDFLARE_ZONE_ID=CHANGE_ME

# The full DNS hostname ddclient should update (must match your DOMAIN)
DDCLIENT_HOSTNAME=vault.example.com

# ==========================================================
# RESOURCE LIMITS
# ==========================================================
# Optimized for OCI A1 Flex (1 OCPU, 6GB RAM) with ~10 users
VAULTWARDEN_MEMORY_LIMIT=1g
CADDY_MEMORY_LIMIT=128m
FAIL2BAN_MEMORY_LIMIT=64m
DDCLIENT_MEMORY_LIMIT=64m

# ==========================================================
# OPTIONAL: SMTP CONFIGURATION
# ==========================================================
# If using email notifications, configure credentials in secrets/secrets.yaml
# Uncomment and set these if needed. Password goes in secrets file.

#SMTP_HOST=smtp.example.com
#SMTP_PORT=587
#SMTP_SECURITY=starttls
#SMTP_USERNAME=vaultwarden@example.com

# ==========================================================
# SECRETS REFERENCE (DO NOT SET HERE)
# ==========================================================
# These are populated securely at runtime from secrets/secrets.yaml
# Use ./edit-secrets.sh to configure these values:
#
# - admin_basic_auth_hash (for Caddy admin panel protection)
# - ddclient_api_token (for DNS updates)
# - fail2ban_api_token (for fail2ban firewall bans)
# - smtp_password (if using email notifications)
# - push_installation_id (if using push notifications)
# - push_installation_key (if using push notifications)

# ==========================================================
# DEVELOPMENT OVERRIDE (Leave commented out)
# ==========================================================
# For local testing, you can override the compose file
#COMPOSE_FILE=docker-compose.yml:docker-compose.override.yml
