[Definition]
# Ban requests for well-known malicious/probing paths (exclude ACME)
# Combines multiple URI patterns into a single, more efficient regex.
failregex = ^.*"uri"\s*:\s*"/(?:\.env|\.git/?|\.htaccess|\.DS_Store|wp-login\.php|wp-admin/?|xmlrpc\.php|wp-json/|phpmyadmin/?|adminer\.php|pma/?|\.vscode|vendor/phpunit|telescope|laravel\.log|config\.json|id_rsa|composer\.(?:json|lock)|jmxconsole|manager/html|actuator|console|hudson|jenkins|CFIDE|solr/?|HNAP1|boaform|Autodiscover/Autodiscover\.xml)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$

ignoreregex = ^.*"uri"\s*:\s*"/\.well-known/acme-challenge/[^"]*".*$