# fail2ban/filter.d/vaultwarden.local
[INCLUDES]
before = common.conf

[Definition]
# This regex is now more specific, anchored to the start of the line with a timestamp.
# This prevents accidentally matching other log lines that might contain similar phrases.
failregex = ^\[....-..-.. ..:..:..\]\[INFO\] \[.*\] \[POST /identity/connect/token\] \[ip: <ADDR>\] \[.*\] \[.*\] Invalid username or password.*$
            ^\[....-..-.. ..:..:..\]\[INFO\] \[.*\] \[POST /api/accounts/prelogin\] \[ip: <ADDR>\] \[.*\] \[.*\] User .* not found.*$

ignoreregex =

