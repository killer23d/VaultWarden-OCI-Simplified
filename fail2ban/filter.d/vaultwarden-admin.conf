# Fail2Ban filter for VaultWarden Admin Panel (Caddy JSON logs via JMESPath)
# File: /etc/fail2ban/filter.d/vaultwarden-admin.conf

[Definition]

# Ban when URI contains /admin and status is 401/403/404/429
failjmespath = [? contains(request.uri, '/admin') && (response.status == 401 || response.status == 403 || response.status == 404 || response.status == 429) ].request.remote_ip

# Explicitly empty since logic is non-regex-based
ignoreregex =
