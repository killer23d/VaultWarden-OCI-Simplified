[Definition]
# Ban obvious scanners/CLI tools by User-Agent
# NOTE: Keep this conservative to avoid false positives. Adjust as needed.
failregex = ^.*"User-Agent"\s*:\s*\[\s*"(?i)(?:python-requests|curl/|wget/|nikto|sqlmap|acunetix|dirbuster|wpscan|zgrab|masscan|fimap|havij|arachni|w3af|ltx71|go-http-client|apachebench|hydra|nessus|openvas)[^"]*"\s*\].*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
ignoreregex = ^.*"User-Agent"\s*:\s*\[\s*"(?:Googlebot|Bingbot|DuckDuckBot|YandexBot|Slackbot|UptimeRobot|Pingdom|StatusCake|healthchecks\.io|FacebookExternalHit|Twitterbot)[^"]*"\s*\].*$
