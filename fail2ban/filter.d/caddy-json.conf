[Definition]
# Match 401/403 and extract client IP from Cf-Connecting-Ip if present, else request.remote_ip.
# JSON examples (Caddy v2):
# {"logger":"http.log.access","request":{"remote_ip":"172.x.x.x","headers":{"Cf-Connecting-Ip":["1.2.3.4"]}}, "status":401, ...}

failregex = ^.*"http\.log\.access".*"status":(?:401|403).*"Cf-Connecting-Ip":\["(?P<host>(?:\d{1,3}\.){3}\d{1,3}|[A-Fa-f0-9:]+)"\].*$
            ^.*"http\.log\.access".*"status":(?:401|403).*"request"\s*:\s*\{.*"remote_ip"\s*:\s*"(?P<host>(?:\d{1,3}\.){3}\d{1,3}|[A-Fa-f0-9:]+)".*$
ignoreregex =
