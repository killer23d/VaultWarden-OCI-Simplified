# VaultWarden-OCI-NG fail2ban jail configuration
# Protects against brute force attacks

[DEFAULT]
# Ban settings
bantime = 1h
findtime = 10m  
maxretry = 5
backend = auto

# Actions
banaction = iptables-multiport
banaction_allports = iptables-allports
action = %(banaction)s[name=%(__name__)s, port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]

# Email notifications (configure SMTP first)
# action = %(banaction)s[name=%(__name__)s, port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]
#          %(mta)s-whois[name=%(__name__)s, sender="%(sender)s", dest="%(destemail)s"]

[vaultwarden-admin]
enabled = true
port = http,https
filter = vaultwarden-admin
logpath = /var/log/caddy/access.log
maxretry = 3
bantime = 2h
findtime = 5m
action = iptables-multiport[name="vaultwarden-admin", port="80,443", protocol="tcp"]

[vaultwarden-api]  
enabled = true
port = http,https
filter = vaultwarden-api
logpath = /var/log/caddy/access.log
maxretry = 10
bantime = 30m
findtime = 10m
action = iptables-multiport[name="vaultwarden-api", port="80,443", protocol="tcp"]

[caddy-botsearch]
enabled = true
port = http,https
filter = caddy-botsearch
logpath = /var/log/caddy/access.log
maxretry = 2
bantime = 24h
findtime = 1h
action = iptables-multiport[name="caddy-botsearch", port="80,443", protocol="tcp"]
