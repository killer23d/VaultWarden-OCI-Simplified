# VaultWarden-OCI-NG fail2ban jail configuration
# File: fail2ban/jail.d/vaultwarden-oci-ng.conf
# This follows standard fail2ban practices by placing custom jails in jail.d/

[DEFAULT]
# Global ban settings - can be overridden per jail
bantime = 1h
findtime = 10m  
maxretry = 5
backend = auto

# Default action for all jails
action = iptables-multiport[name=%(__name__)s, port="%(port)s", protocol="%(protocol)s"]

[vaultwarden-admin]
# Protect VaultWarden admin panel from brute force attacks
enabled = true
port = http,https
filter = vaultwarden-admin
logpath = /var/log/caddy/access.log
maxretry = 3
bantime = 2h
findtime = 5m
action = iptables-multiport[name="vaultwarden-admin", port="80,443", protocol="tcp"]

[vaultwarden-api]  
# Protect VaultWarden API endpoints from brute force
enabled = true
port = http,https
filter = vaultwarden-api
logpath = /var/log/caddy/access.log
maxretry = 10
bantime = 30m
findtime = 10m
action = iptables-multiport[name="vaultwarden-api", port="80,443", protocol="tcp"]

[caddy-botsearch]
# Block bots and scanners attempting common attack paths
enabled = true
port = http,https
filter = caddy-botsearch
logpath = /var/log/caddy/access.log
maxretry = 2
bantime = 24h
findtime = 1h
action = iptables-multiport[name="caddy-botsearch", port="80,443", protocol="tcp"]
